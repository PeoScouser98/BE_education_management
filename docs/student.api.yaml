paths:
    /students:
        post:
            tags:
                - Students
            summary: Đăng nhập với tư cách giáo viên chủ nhiệm lớp hoặc hiệu trưởng
            description: Tạo mới 1 hoặc nhiểu student bằng cách gửi { } hoặc [ ]
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                class:
                                    type: string
                                    required: true
                                fullName:
                                    type: string
                                    required: true
                                    minLength: 6
                                    maxLength: 100
                                gender:
                                    type: string
                                    required: true
                                dateOfBirth:
                                    type: date
                                    required: true
                                parentsPhoneNumber:
                                    type: string
                                    required: true
                                isPolicyBeneficiary:
                                    type: boolean
                                isGraduated:
                                    type: boolean
                        example:
                            {
                                class: '6410a8a01e0ac1f41b6ddc00',
                                fullName: 'Lê Ngọc Đức 5',
                                gender: true,
                                dateOfBirth: '10-13-2001',
                                parentsPhoneNumber: '032856808888',
                            }
            responses:
                200:
                    description: Student created successfully
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Student'
                            example:
                                {
                                    'class': '6410a8a01e0ac1f41b6ddc00',
                                    'fullName': 'Lê Ngọc Đức 5',
                                    'gender': true,
                                    'dateOfBirth': '2001-10-12T17:00:00.000Z',
                                    'parentsPhoneNumber': '032856808888',
                                    'isPolicyBeneficiary': false,
                                    'isGraduated': false,
                                    '_id': '641c986f5bc01247c99c3723',
                                    'deleted': false,
                                    'absentDays': [],
                                    'createdAt': '2023-03-23T18:20:31.120Z',
                                    'updatedAt': '2023-03-23T18:20:31.120Z',
                                    'code': '5lndBX8888',
                                    '__v': 0,
                                }
                204:
                    description: Không nhận được request body
                400:
                    description: Không thỏa mã validate
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpResponse'
                            example:
                                {
                                    statusCode: 400,
                                    message: The student does not satisfy the validation requirements,
                                    error:
                                        [
                                            {
                                                'fullName': 'Lê Ngọc Đức 5',
                                                'parentPhone': '032856808888',
                                                'message': '"gender" must be a boolean',
                                            },
                                        ],
                                }
                413:
                    description: Thêm trên 50 học sinh cùng lúc
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpResponse'
                            example:
                                {
                                    statusCode: 413,
                                    message: You are only allowed to add 50 students at a time,
                                }
                409:
                    description: Học sinh đã tồn tại
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpResponse'
                            example:
                                {
                                    statusCode: 409,
                                    message: Student already exists,
                                    error:
                                        [
                                            {
                                                'fullName': 'Lê Ngọc Đức 5',
                                                'parentPhone': '032856808888',
                                            },
                                        ],
                                }

    /students/stop/:type:
        get:
            tags:
                - Students
            summary: Đăng nhập với tư cách là hiệu trưởng
            description: Lấy ra danh sách học sinh chuyển trường hoặc nghỉ học theo năm
            parameters:
                - name: type
                  in: path
                  description: Lựa chọn hành động muốn thực hiện
                  required: true
                  schema:
                      type: string
                      enum:
                          - transferSchool
                          - dropout
                - name: year
                  in: query
                  description: Lấy ra hs của năm ...
                  schema:
                      type: number
                      enum:
                          - all
                          - số năm truyền lên
                  default: năm hiện tại
                - name: page
                  in: query
                  description: page phân trang
                  schema:
                      type: number
                  default: 1
                - name: limit
                  in: query
                  description: Số bản ghi của 1 page
                  schema:
                      type: number
                  default: 10

            responses:
                200:
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/StudentResponse'
                            example:
                                {
                                    'docs':
                                        [
                                            {
                                                'dropoutDate': null,
                                                '_id': '641c92fd17e975b09d28d965',
                                                'code': '26lndBX8088',
                                                'class': '6410a8a01e0ac1f41b6ddc00',
                                                'fullName': 'Lê Ngọc Đức 26',
                                                'gender': true,
                                                'dateOfBirth': '2001-10-12T17:00:00.000Z',
                                                'parentsPhoneNumber': '0328568088',
                                                'isPolicyBeneficiary': false,
                                                'isGraduated': false,
                                                'deleted': false,
                                                'absentDays': [],
                                                '__v': 0,
                                                'createdAt': '2023-03-23T17:57:17.057Z',
                                                'updatedAt': '2023-03-24T14:28:15.228Z',
                                                'transferSchool': '2023-03-23T17:00:00.000Z',
                                            },
                                        ],
                                    'totalDocs': 1,
                                    'limit': 10,
                                    'totalPages': 1,
                                    'page': 1,
                                    'pagingCounter': 1,
                                    'hasPrevPage': false,
                                    'hasNextPage': false,
                                    'prevPage': null,
                                    'nextPage': null,
                                }

                400:
                    description: Không nhận được type
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpResponse'
                            example: { statusCode: 400, message: Type is not valid }

    /students/:classId:
        get:
            tags:
                - Students
            description: Lấy ra học sinh của 1 lớp
            summary: Đăng nhập
            parameters:
                - name: classId
                  in: path
                  description: Id class muốn lấy học sinh
                  required: true
                  schema:
                      type: string
                - name: _order
                  in: query
                  description: Kiểu sắp xếp
                  schema:
                      type: SortOrder
                      enum:
                          - asc
                          - desc
                  default: desc
                - name: _sort
                  in: query
                  description: sắp xếp theo thuộc tính _sort
                  schema:
                      type: string
                      enum:
                          - code
                          - fullName
                          - gender
                          - dateOfBirth
                          - class
                          - parentsPhoneNumber
                          - isPolicyBeneficiary
                          - isGraduated
                  default: fullName
                - name: select
                  in: query
                  description: Thiết lập các thuộc tính muốn nhận được
                  schema:
                      type: string
                  default: '-absentDays'
                - name: page
                  in: query
                  description: page phân trang
                  schema:
                      type: number
                  default: 1
                - name: limit
                  in: query
                  description: Số bản ghi của 1 page
                  schema:
                      type: number
                  default: 10
            responses:
                200:
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/StudentResponse'
                            example:
                                {
                                    'docs':
                                        [
                                            {
                                                'dropoutDate': null,
                                                '_id': '641c92fd17e975b09d28d965',
                                                'code': '26lndBX8088',
                                                'class': '6410a8a01e0ac1f41b6ddc00',
                                                'fullName': 'Lê Ngọc Đức 26',
                                                'gender': true,
                                                'dateOfBirth': '2001-10-12T17:00:00.000Z',
                                                'parentsPhoneNumber': '0328568088',
                                                'isPolicyBeneficiary': false,
                                                'isGraduated': false,
                                                'deleted': false,
                                                'absentDays': [],
                                                '__v': 0,
                                                'createdAt': '2023-03-23T17:57:17.057Z',
                                                'updatedAt': '2023-03-24T14:28:15.228Z',
                                                'transferSchool': null,
                                            },
                                        ],
                                    'totalDocs': 1,
                                    'limit': 10,
                                    'totalPages': 1,
                                    'page': 1,
                                    'pagingCounter': 1,
                                    'hasPrevPage': false,
                                    'hasNextPage': false,
                                    'prevPage': null,
                                    'nextPage': null,
                                }

                400:
                    description: Không đúng định dạng id hoặc _sort query không chính xác
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpError'
                            example:
                                {
                                    statusCode: 400,
                                    message: "_sort can only belong to ['code','fullName','gender','dateOfBirth','class','parentsPhoneNumber','isPolicyBeneficiary','isGraduated'] | _id of the class is invalid",
                                }

    /student/services/:id:
        put:
            tags:
                - Students
            description: Chuyển trạng thái 1 học sinh thành đã nghỉ học hoặc chuyển trường
            summary: Đăng nhập với vai trò HEADMASTER
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                type:
                                    type: string
                                    enum:
                                        - transferSchool
                                        - dropout
                                date:
                                    type: date

                        example: { type: transferSchool, date: '03-24-2023' }

            responses:
                201:
                    description: Cập nhập thành công
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Student'
                            example:
                                {
                                    'dropoutDate': null,
                                    '_id': '641c92fd17e975b09d28d965',
                                    'code': '26lndBX8088',
                                    'class': '6410a8a01e0ac1f41b6ddc00',
                                    'fullName': 'Lê Ngọc Đức 26',
                                    'gender': true,
                                    'dateOfBirth': '2001-10-12T17:00:00.000Z',
                                    'parentsPhoneNumber': '0328568088',
                                    'isPolicyBeneficiary': false,
                                    'isGraduated': false,
                                    'deleted': false,
                                    'absentDays': [],
                                    '__v': 0,
                                    'createdAt': '2023-03-23T17:57:17.057Z',
                                    'updatedAt': '2023-03-24T14:28:15.228Z',
                                    'transferSchool': null,
                                }
                400:
                    description: Truyền type không chính xác hoặc id || date không đúng định dạng
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpError'
                            example:
                                {
                                    statusCode: 400,
                                    message: 'Type is not valid | _id of the student is invalid | The Date you passed is not in the correct Date data type',
                                }

                404:
                    description: Học sinh đã chuyển đi hoặc nghỉ học
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpError'
                            example:
                                {
                                    statusCode: 400,
                                    message: 'The student has transferred to another school or dropped out',
                                }

    /student/:id:
        put:
            tags:
                - Students
            description: Cập nhập lại thông tin của 1 học sinh
            summary: Đăng nhập với vai trò giáo viên chủ nhiệm lớp
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                class:
                                    type: ObjectId
                                    required: true
                                fullName:
                                    type: string
                                    required: true
                                    minLength: 6
                                    maxLength: 100
                                gender:
                                    type: boolean
                                    require: true
                                dateOfBirth:
                                    type: Date
                                    require: true
                                parentsPhoneNumber:
                                    type: string
                                    require: true
                                    pattern: '/^(?:\+84|0)(?:1\d{9}|3\d{8}|5\d{8}|7\d{8}|8\d{8}|9\d{8})$/'
                                isPolicyBeneficiary:
                                    type: boolean
                                isGraduated:
                                    type: boolean

                        example:
                            {
                                'fullName': 'Lê Ngọc Đức 26',
                                'gender': true,
                                'parentsPhoneNumber': '0328568088',
                            }

            responses:
                201:
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Student'
                            example:
                                {
                                    'dropoutDate': null,
                                    '_id': '641c92fd17e975b09d28d965',
                                    'code': '26lndBX8088',
                                    'class': '6410a8a01e0ac1f41b6ddc00',
                                    'fullName': 'Lê Ngọc Đức 26',
                                    'gender': true,
                                    'dateOfBirth': '2001-10-12T17:00:00.000Z',
                                    'parentsPhoneNumber': '0328568088',
                                    'isPolicyBeneficiary': false,
                                    'isGraduated': false,
                                    'deleted': false,
                                    'absentDays': [],
                                    '__v': 0,
                                    'createdAt': '2023-03-23T17:57:17.057Z',
                                    'updatedAt': '2023-03-24T14:28:15.228Z',
                                    'transferSchool': null,
                                }

                204:
                    description: Data body rỗng
                304:
                    description: Dữ liệu thay đổi giống dữ liệu tồn tại trong database
                400:
                    description: Không thỏa mã validate hoặc id không đúng type objectId
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpError'
                            example:
                                {
                                    statusCode: 400,
                                    message: '_id of the student is invalid | "gender" must be a boolean',
                                }
                404:
                    description: Học sinh không tồn tại
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpError'
                            example: { statusCode: 404, message: 'Student does not exist!' }

        get:
            tags:
                - Students
            description: Lấy ra đầy đủ thông tin một học sinh
            summary: Đăng nhập với vai trò phụ huynh học sinh hoặc giáo viên

            responses:
                200:
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/Student'
                            example:
                                {
                                    'dropoutDate': null,
                                    '_id': '641c92fd17e975b09d28d965',
                                    'code': '26lndBX8088',
                                    'class':
                                        {
                                            '_id': '6410a8a01e0ac1f41b6ddc00',
                                            'className': '2D',
                                            'headTeacher': '637ec5ce577ebd6709c65124',
                                        },
                                    'fullName': 'Lê Ngọc Đức 26',
                                    'gender': true,
                                    'dateOfBirth': '2001-10-12T17:00:00.000Z',
                                    'parentsPhoneNumber': '0328568088',
                                    'isPolicyBeneficiary': false,
                                    'isGraduated': false,
                                    'deleted': false,
                                    'absentDays': [],
                                    '__v': 0,
                                    'createdAt': '2023-03-23T17:57:17.057Z',
                                    'updatedAt': '2023-03-24T16:48:20.678Z',
                                    'transferSchool': '2023-03-23T17:00:00.000Z',
                                }

                400:
                    description: Id không đúng định dạng hoặc không nhận được id
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpError'
                            example: { statusCode: 400, message: '_id of the student is invalid' }

                404:
                    description: Học sinh không tồn tại
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HttpError'
                            example: { statusCode: 404, message: 'Student does not exist!' }
